# CPI STACK CALCULATION

### NOTE

The data collecetd after running the gapbs and rodinia benchmark program have been added **perf_training_gaps.csv** and **perf_training_rodinia.csv**.


## RODINIA BENCHMARK

The data about L1-I cache miss,L1-D cache miss,L2 cache miss,L3 cache miss, Branch miss-prediction, I-TLB miss, D-TLB miss were collected by running the bfs program as it was done in the 2.a) question.

````
perf stat -e L1-dcache-load-misses,L1-icache-load-misses,l2_rqsts.miss,dTLB-load-misses,iTLB-load-misses,br_misp_retired.all_branches_pebs,cycles,instructions -I 10 -x, -o rodinia_data.csv ./bfs graph33554432.txt 1
````

The python script data_processin.py is run to convert the data from rodinia_data.csv to a format X,Y such that X contains the values of the 7 parameters that we are measuring and Y has value of the CPI which can be used for training the regression model.

NOTE: The rodinia_data.csv (the output file generated by perf command ) should be in the same directory as the python script

Run the data_processing.py script and enter the name of the input csv file on which processing should be done and the name of the output file where the results must be stored.

NOTE: if the file name is ABCD.csv, just enter ABCD

The processed data is stored in a new csv file where X is a list where each entry is a tuple with 7 values which were measured using perf and Y has the CPI values.

````
python data_processin.py
````

Now the model.py is run to train the regression model which takes as input the name of the processed .csv fie and outputs the parameters of the model.

NOTE: if the file name is ABCD.csv, just enter ABCD
````
python model.py
````


## GAPBS BENCHMARK

The data about L1-I cache miss,L1-D cache miss,L2 cache miss,L3 cache miss, Branch miss-prediction, I-TLB miss, D-TLB miss were collected by running the bfs program as it was done in the 2.a) question.

````
perf stat -e L1-dcache-load-misses,L1-icache-load-misses,l2_rqsts.miss,dTLB-load-misses,iTLB-load-misses,br_misp_retired.all_branches_pebs,cycles,instructions -I 10 -x, -o gapbs_data.csv ./bfs -u 25 -n 1
````

The python script data_processin.py is run to convert the data from gapbs_data.csv to a format X,Y such that X contains the values of the 7 parameters that we are measuring and Y has value of the CPI which can be used for training the regression model.

NOTE: The gapbs_data.csv (the output file generated by perf command ) should be in the same directory as the python script.

Run the data_processing.py script and enter the name of the input csv file on which processing should be done and the name of the output file where the results must be stored.

NOTE: if the file name is ABCD.csv, just enter ABCD

The processed data is stored in a new csv file where X is a list where each entry is a tuple with 7 values which were measured using perf and Y has the CPI values.

````
python data_processin.py
````

Now the model.py is run to train the regression model which takes the gapbs_processed_data.csv as input and output the parameters of the model.

NOTE: if the file name is ABCD.csv, just enter ABCD
````
python model.py
````

